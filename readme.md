Это - конспект доклада Евгения Борисова "Спринг-построитель" на онлайн-конференции JUG.RU от 17 мая 2020г.
Запись находится по адресу https://www.youtube.com/watch?v=rd6wxPzXQvo

#Введение

Цель данной работы - поближе познакомиться со Спрингом, получить понятия об основных концепциях IoC, посмотреть как работает Спринг изнутри.

Для этого напишем приложение "CoronaDesinfector".
В процессе написания возникнет необходимость написать инфраструктуру, которая позволит переиспользовать код, сделает код гибким. 
И, самое главное, поможет нам соблюсти все правила SOLID.
При дальннейшем развитии этой инфраструктуры у нас появится фреймворк, очень похожий  на Спринг.
Это поможет лучше понять Спринг не только как пользователь, но и как создатель.

Пишем на Java 11. Зависимости:
jsr-250 для аннотации PostConstruct,  
lombok для экономии времени
org.reflections - расширение стандартной Рефлекшн-Api
(в конце добавится CGLib)

*****
# Часть 1. Основные классы по ТЗ
Создадим 2 класса,  
    CoronaDesinfector
    Room

Дезинфектор по ТЗ выполоняет 4 действия:
    - Делает объявление, что сейчас начнется дезинфекция, всем покинуть помещение
    - Всем, кто не вышел сам, поможет полицейский
    - Собственно, дезинфекция
    - Объявление, что можно зайти обратно

Объявления будет делать специальный класс Announcer. 
Но на случай если мы захотим сделать разные виды объявлений, 
лучше сделаем интерфейс Announcer с методом announce(), и его реализацию ConsoleAnnouncer 

Полицейский тоже будет интерфейсом Policeman с методом makePeopleLeaveRoom(), 
и реализацией PolicemanImpl

в Дезинфекторе сделаем поля типа Полицейский и Анонсер, 
и назначим им по новому объекту соответствующих имплементаций.

в Main создадим экземпляр Дезинфектора и вызовем метод desinfect()
...Проверяем, все работает.

*****
# ЧАСТЬ 2. Cчитаем ответственности класса Дезинфектор.

Казалось бы, наш Дезинфектор отвечает только за дезинфекцию
Однако если присмотреться, single responsibility тут и не пахнет:
на данный момент у этого класса более 7 ответственностей

Кроме методов start() и desinfect() у нас тут 2 поля Announcer и Policeman, которые создаются здесь же. Annoouncer - это интерфейс, и, возможно, в будущем появятся и другие его имплементации. То есть класс CoronaDesinfector принимает решение, что именно ConsoleAnnouncer должен быть использован в качестве Announcer для данного приложения. Сейчас это решение захардкожено, но если появится логика, по которой нужно будет выбрать подходящую имплементацию, то вся эта логика будет находиться здесь же. Например, идет в ENVIRONMENT_VARIABLE смотрит locale чтобы узнать, в какой стране находится компьютер, на котором запущено наше приложение. Чтобы в зависимости от этого выбрать нужную имплементацию, которая говорит на нужном языке и в соответствии с законами и правилами этой страны. А это уже не имеет никакого отношения к дезинфекции.

Третья ответственностль - наш Дезинфектор также должен поимать, как именно должен создаваться Анонсер: сегодня это просто пустой корнструктор, а завтра этот конструктор поменяют и т.д. И придется пререписывать также и Дезинфектор.

- А еще наш Дезинфектор должен уметь настроить Анонсер.
  В данный момент это не требуется, но если завтра ConsoleAnnouncer обрастет пропертями (например, громкость)
  и их надо будет настраивать при помощи сеттеров и т.д... В этом случае ответственность за настройку лолжится на Дезинфектор.

Все то же самое касается и Полисмена.
Итого всего 7 ответственностей. И если завтра появится другая имплементация Анонсера, то нам нужно знать все то же самое про неё...

Если подытожить, нашему дезинфектору нужно
1) дезинфицирповать
2) уметь создавать объекты
